window.appAspro=window.appAspro||{},window.appAspro.marketing||(window.appAspro.marketing={inited:!1,showPopup:function(){if($(".dyn_mp_jqm").length){var allDelays=[];$(".dyn_mp_jqm").each((function(i,el){var jqmBlock=$(el),delay=0;if(!jqmBlock.hasClass("initied")){for(jqmBlock.addClass("initied"),jqmBlock.data("param-delay")&&(delay=1e3*jqmBlock.data("param-delay"));-1!==allDelays.indexOf(delay);)delay+=100;if(allDelays.push(delay),"undefined"!=typeof localStorage){let lsKey=jqmBlock.data("ls");var dataLS=localStorage.getItem(lsKey),ls="";try{ls=JSON.parse(dataLS)}catch(e){ls=dataLS}let bShowOnCurrentDevice=!0;try{let mediaSelector=jqmBlock.data("media-query");mediaSelector&&(matchMedia(mediaSelector).matches||(bShowOnCurrentDevice=!1))}catch(error){}bShowOnCurrentDevice&&(!ls||ls&&("Y"===ls.SHOW_ALWAYS||ls.TIMESTAMP<Date.now()&&ls.TIMESTAMP))&&(timeoutID=setTimeout((function(){jqmBlock.click()}),delay)),ls&&"N"===ls.SHOW_ALWAYS&&ls.TIMESTAMP<Date.now()&&ls.TIMESTAMP&&(ls.SHOW_ALWAYS="Y",localStorage.setItem(lsKey,JSON.stringify(ls)))}else{var ls;(ls=$.cookie(jqmBlock.data("ls")))||(timeoutID=setTimeout((function(){jqmBlock.click()}),delay))}}}))}},stopShowAlways:function(lsKey){if("undefined"!=typeof localStorage){let dataLS=localStorage.getItem(lsKey),ls="";try{ls=JSON.parse(dataLS)}catch(e){ls=dataLS}ls&&(ls.SHOW_ALWAYS="N",localStorage.setItem(lsKey,JSON.stringify(ls)))}},checkStopAction:function(lsKey,action){let allStopActions=$(".dyn_mp_jqm[data-ls="+lsKey+"]").data("stop-actions"),bNeedStopShow=!1;if(allStopActions){let arStopActions;bNeedStopShow=-1!==allStopActions.split(",").indexOf(action)}return bNeedStopShow}}),appAspro.marketing.inited||(appAspro.marketing.inited=!0,$(document).ready((function(){BX.addCustomEvent("onMarketingPopupClose",(function(eventdata){if(eventdata){let mpFrame,popupWrap,lsKey=eventdata.hash.w.find(".marketing-popup").data("ls");if(lsKey){let bNeedStopShow;appAspro.marketing.checkStopAction(lsKey,"close")&&appAspro.marketing.stopShowAlways(lsKey)}}})),BX.addCustomEvent("onMarketingPopupShow",(function(eventdata){if(eventdata){let hash=eventdata.hash;if(" undefined"!=typeof $(hash.t).data("ls")&&$(hash.t).data("ls")){var ls=$(hash.t).data("ls"),ls_timeout=0,v="";if($(hash.t).data("ls_timeout")&&(ls_timeout=$(hash.t).data("ls_timeout")),ls_timeout=ls_timeout?Date.now()+1e3*ls_timeout:"","undefined"!=typeof localStorage){var val=localStorage.getItem(ls);try{v=JSON.parse(val)}catch(e){v=val}null!=v&&localStorage.removeItem(ls),(v={}).VALUE="Y",v.TIMESTAMP=ls_timeout,$(hash.t).data("show_always")&&(v.SHOW_ALWAYS=$(hash.t).data("show_always")),localStorage.setItem(ls,JSON.stringify(v))}else{var val;(val=$.cookie(ls))||$.cookie(ls,"Y",{expires:ls_timeout})}var dopClasses=hash.w.find(".marketing-popup").data("classes");dopClasses&&hash.w.addClass(dopClasses)}}})),appAspro.marketing.showPopup(),void 0!==window.frameCacheVars&&BX.addCustomEvent("onFrameDataReceived",(function(json){appAspro.marketing.showPopup()}))})),$(document).on("click",".dyn_mp_jqm_frame [data-marketing-action]",(function(e){let mpFrame=$(this).closest(".dyn_mp_jqm_frame"),popupWrap=$(this).closest(".marketing-popup"),lsKey=popupWrap.data("ls"),bNeedStopShow=!1,btnAction=$(this).attr("data-marketing-action"),bLockClose=mpFrame.hasClass("jqm-lock-close");if(bNeedStopShow=appAspro.marketing.checkStopAction(lsKey,btnAction),"btn1"===btnAction)bLockClose&&(mpFrame.removeClass("jqm-lock-close"),bNeedStopShow=!0);else{let disagreePopup=mpFrame.find(".marketing-popup-disagree");bLockClose&&(popupWrap.length&&popupWrap.hide(),disagreePopup.length&&disagreePopup.removeClass("hidden"),bNeedStopShow=!1)}bNeedStopShow&&appAspro.marketing.stopShowAlways(lsKey),mpFrame.jqmHide()})),$(document).on("click",".coupon-block",(function(e){let couponText=this.querySelector(".coupon-block__text").textContent.trim();navigator.clipboard&&navigator.clipboard.writeText(couponText).then(()=>{}).catch(()=>{console.log("error copy")})})));